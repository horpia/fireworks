(()=>{var t={541:(t,e,i)=>{var s=i(202);t.exports=(s.default||s).template({compiler:[8,">= 4.3.0"],main:function(t,e,i,s,o){var r,n=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<img src="'+t.escapeExpression("function"==typeof(r=null!=(r=n(i,"assetsUrl")||(null!=e?n(e,"assetsUrl"):e))?r:t.hooks.helperMissing)?r.call(null!=e?e:t.nullContext||{},{name:"assetsUrl",hash:{},data:o,loc:{start:{line:1,column:10},end:{line:1,column:23}}}):r)+'/img/pechenka.svg" width="100" alt="Печенька">'},useData:!0})},632:(t,e,i)=>{var s=i(202);t.exports=(s.default||s).template({compiler:[8,">= 4.3.0"],main:function(t,e,i,s,o){var r,n=null!=e?e:t.nullContext||{},a=t.hooks.helperMissing,l="function",h=t.escapeExpression,c=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<fw-canvas id="fw1"\n\tfullscreen\n\tsounds-url="'+h(typeof(r=null!=(r=c(i,"assetsUrl")||(null!=e?c(e,"assetsUrl"):e))?r:a)===l?r.call(n,{name:"assetsUrl",hash:{},data:o,loc:{start:{line:3,column:13},end:{line:3,column:26}}}):r)+'/sounds"\n\tbg-image="'+h(typeof(r=null!=(r=c(i,"assetsUrl")||(null!=e?c(e,"assetsUrl"):e))?r:a)===l?r.call(n,{name:"assetsUrl",hash:{},data:o,loc:{start:{line:4,column:11},end:{line:4,column:24}}}):r)+'/img/snow-city-bg.png?2"></fw-canvas>\n<div class="caption">найди и запусти такой фейерверк</div>\n<div class="lives">\n\t<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n\t\t width="28" height="28" viewBox="0 0 511.626 511.626">\n\t\t<path d="M475.366,71.949c-24.175-23.606-57.575-35.404-100.215-35.404c-11.8,0-23.843,2.046-36.117,6.136\n\t\t\tc-12.279,4.093-23.702,9.615-34.256,16.562c-10.568,6.945-19.65,13.467-27.269,19.556c-7.61,6.091-14.845,12.564-21.696,19.414\n\t\t\tc-6.854-6.85-14.087-13.323-21.698-19.414c-7.616-6.089-16.702-12.607-27.268-19.556c-10.564-6.95-21.985-12.468-34.261-16.562\n\t\t\tc-12.275-4.089-24.316-6.136-36.116-6.136c-42.637,0-76.039,11.801-100.211,35.404C12.087,95.55,0,128.286,0,170.16\n\t\t\tc0,12.753,2.24,25.891,6.711,39.398c4.471,13.514,9.566,25.031,15.275,34.546c5.708,9.514,12.181,18.792,19.414,27.834\n\t\t\tc7.233,9.041,12.519,15.272,15.846,18.698c3.33,3.426,5.948,5.903,7.851,7.427L243.25,469.938\n\t\t\tc3.427,3.426,7.614,5.144,12.562,5.144s9.138-1.718,12.563-5.144l177.87-171.31c43.588-43.58,65.38-86.406,65.38-128.472\n\t\t\tC511.626,128.279,499.54,95.546,475.366,71.949z M421.405,271.795L255.813,431.391L89.938,271.507\n\t\t\tC54.344,235.922,36.55,202.133,36.55,170.156c0-15.415,2.046-29.026,6.136-40.824c4.093-11.8,9.327-21.177,15.703-28.124\n\t\t\tc6.377-6.949,14.132-12.607,23.268-16.988c9.141-4.377,18.086-7.328,26.84-8.85c8.754-1.52,18.079-2.281,27.978-2.281\n\t\t\tc9.896,0,20.557,2.424,31.977,7.279c11.418,4.853,21.934,10.944,31.545,18.271c9.613,7.332,17.845,14.183,24.7,20.557\n\t\t\tc6.851,6.38,12.559,12.229,17.128,17.559c3.424,4.189,8.091,6.283,13.989,6.283c5.9,0,10.562-2.094,13.99-6.283\n\t\t\tc4.568-5.33,10.28-11.182,17.131-17.559c6.852-6.374,15.085-13.222,24.694-20.557c9.613-7.327,20.129-13.418,31.553-18.271\n\t\t\tc11.416-4.854,22.08-7.279,31.977-7.279s19.219,0.761,27.977,2.281c8.757,1.521,17.702,4.473,26.84,8.85\n\t\t\tc9.137,4.38,16.892,10.042,23.267,16.988c6.376,6.947,11.612,16.324,15.705,28.124c4.086,11.798,6.132,25.409,6.132,40.824\n\t\t\tC475.078,202.133,457.19,236.016,421.405,271.795z"/>\n\t</svg>\n\t<span>5</span>\n</div>\n<div class="score">\n\t<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24">\n\t\t<path d="M12 5.173l2.335 4.817 5.305.732-3.861 3.71.942 5.27-4.721-2.524-4.721 2.525.942-5.27-3.861-3.71\n\t\t\t5.305-.733 2.335-4.817zm0-4.586l-3.668 7.568-8.332 1.151 6.064 5.828-1.48 8.279 7.416-3.967 7.416\n\t\t\t3.966-1.48-8.279 6.064-5.827-8.332-1.15-3.668-7.569z"/>\n\t</svg>\n\t<span>0</span>\n</div>\n<div class="score-final">\n\t<div class="current-score">\n\t\t<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24">\n\t\t\t<path d="M12 5.173l2.335 4.817 5.305.732-3.861 3.71.942 5.27-4.721-2.524-4.721 2.525.942-5.27-3.861-3.71\n\t\t\t\t5.305-.733 2.335-4.817zm0-4.586l-3.668 7.568-8.332 1.151 6.064 5.828-1.48 8.279 7.416-3.967 7.416\n\t\t\t\t3.966-1.48-8.279 6.064-5.827-8.332-1.15-3.668-7.569z"/>\n\t\t</svg>\n\t\t<span>0</span>\n\t</div>\n\t<div class="best-score">ваш лучший результат: <span>0</span></div>\n</div>\n<div data-role="start" class="start-button">\n\tНАЧАТЬ ИГРУ\n</div>\n<div data-role="close" class="close-button" title="Закрыть игру">\n\t<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n\t\tviewBox="0 0 640 640" width="26" height="26">\n\t\t<path d="M625.32 512.46C630.14 517.37 630.06 525.26 625.15 530.08C603.21 551.61\n\t\t546.28 607.49 524.34 629.02C519.43 633.84 511.54 633.77 506.73 628.86C406.57 526.82 114.84\n\t\t229.58 14.68 127.54C9.86 122.63 9.94 114.74 14.85 109.92C36.79 88.39 93.72 32.51 115.66\n\t\t10.98C120.57 6.16 128.46 6.23 133.27 11.14C233.43 113.18 525.16 410.42 625.32 512.46Z"></path>\n\t\t<path d="M17.42 512.46C12.6 517.37 12.68 525.26 17.59 530.08C39.53 551.61 96.46 607.49\n\t\t118.4 629.02C123.31 633.84 131.2 633.77 136.02 628.86C236.17 526.82 527.91 229.58 628.06\n\t\t127.54C632.88 122.63 632.81 114.74 627.9 109.92C605.96 88.39 549.02 32.51 527.08 10.98C522.17\n\t\t6.16 514.29 6.23 509.47 11.14C409.31 113.18 117.58 410.42 17.42 512.46Z"></path>\n\t</svg>\n</div>\n<div data-role="mute" class="mute-button" title="Отключить звук">\n\t<svg height="32" viewBox="0 0 512 512" width="32"\n\t\t xmlns="http://www.w3.org/2000/svg">\n\t\t<path d="m111.875 352 129.546 99.064c4.186 3.202 9.309 4.936 14.579 4.936h24c13.255 0 24-10.745\n\t\t24-24v-352c0-13.255-10.745-24-24-24h-24c-5.27 0-10.393 1.734-14.579 4.936l-129.546 99.064h-67.875c-24.262\n\t\t0-44 19.738-44 44v104c0 24.262 19.738 44 44 44zm144.125-241.787v291.574l-112-85.647v-120.28zm-208\n\t\t97.787h48v96h-48z"/>\n\t\t<path d="m504.971 175.029c-9.373-9.373-24.568-9.373-33.941 0l-47.03 47.03-47.029-47.029\n\t\tc-9.373-9.373-24.568-9.373-33.941 0-9.372 9.373-9.372 24.568 0 33.941l47.029 47.029-47.029 47.029\n\t\tc-9.372 9.373-9.372 24.568 0 33.941 4.686 4.687 10.827 7.03 16.97 7.03s12.284-2.343 16.971-7.029l47.029-47.03\n\t\t47.029 47.029c4.687 4.687 10.828 7.03 16.971 7.03s12.284-2.343 16.971-7.029c9.372-9.373 9.372-24.568\n\t\t0-33.941l-47.03-47.03 47.029-47.029c9.373-9.373 9.373-24.569.001-33.942z"/>\n\t</svg>\n</div>\n<div data-role="turnoff" class="turn-off-button" title="Больше не показывать игру">\n\t<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n\t width="26" height="26" viewBox="0 0 475.085 475.085">\n\t<path d="M237.545,255.816c9.899,0,18.468-3.609,25.696-10.848c7.23-7.229,10.854-15.799,10.854-25.694V36.547\n\t\tc0-9.9-3.62-18.464-10.854-25.693C256.014,3.617,247.444,0,237.545,0c-9.9,0-18.464,3.621-25.697,10.854\n\t\tc-7.233,7.229-10.85,15.797-10.85,25.693v182.728c0,9.895,3.617,18.464,10.85,25.694\n\t\tC219.081,252.207,227.648,255.816,237.545,255.816z"/>\n\t<path d="M433.836,157.887c-15.325-30.642-36.878-56.339-64.666-77.084c-7.994-6.09-17.035-8.47-27.123-7.139\n\t\tc-10.089,1.333-18.083,6.091-23.983,14.273c-6.091,7.993-8.418,16.986-6.994,26.979c1.423,9.998,6.139,18.037,14.133,24.128\n\t\tc18.645,14.084,33.072,31.312,43.25,51.678c10.184,20.364,15.27,42.065,15.27,65.091c0,19.801-3.854,38.688-11.561,56.678\n\t\tc-7.706,17.987-18.13,33.544-31.265,46.679c-13.135,13.131-28.688,23.551-46.678,31.261c-17.987,7.71-36.878,11.57-56.673,11.57\n\t\tc-19.792,0-38.684-3.86-56.671-11.57c-17.989-7.71-33.547-18.13-46.682-31.261c-13.129-13.135-23.551-28.691-31.261-46.679\n\t\tc-7.708-17.99-11.563-36.877-11.563-56.678c0-23.026,5.092-44.724,15.274-65.091c10.183-20.364,24.601-37.591,43.253-51.678\n\t\tc7.994-6.095,12.703-14.133,14.133-24.128c1.427-9.989-0.903-18.986-6.995-26.979c-5.901-8.182-13.844-12.941-23.839-14.273\n\t\tc-9.994-1.332-19.085,1.049-27.268,7.139c-27.792,20.745-49.344,46.442-64.669,77.084c-15.324,30.646-22.983,63.288-22.983,97.927\n\t\tc0,29.697,5.806,58.054,17.415,85.082c11.613,27.028,27.218,50.34,46.826,69.948c19.602,19.603,42.919,35.215,69.949,46.815\n\t\tc27.028,11.615,55.388,17.426,85.08,17.426c29.693,0,58.052-5.811,85.081-17.426c27.031-11.604,50.347-27.213,69.952-46.815\n\t\tc19.602-19.602,35.207-42.92,46.818-69.948s17.412-55.392,17.412-85.082C456.809,221.174,449.16,188.532,433.836,157.887z"/>\n</svg>\n</div>'},useData:!0})},834:(t,e,i)=>{"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}e.__esModule=!0;var r=o(i(67)),n=s(i(558)),a=s(i(728)),l=o(i(392)),h=o(i(628)),c=s(i(982));function d(){var t=new r.HandlebarsEnvironment;return l.extend(t,r),t.SafeString=n.default,t.Exception=a.default,t.Utils=l,t.escapeExpression=l.escapeExpression,t.VM=h,t.template=function(e){return h.template(e,t)},t}var u=d();u.create=d,c.default(u),u.default=u,e.default=u,t.exports=e.default},67:(t,e,i)=>{"use strict";function s(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.HandlebarsEnvironment=d;var o=i(392),r=s(i(728)),n=i(638),a=i(881),l=s(i(37)),h=i(293);e.VERSION="4.7.6",e.COMPILER_REVISION=8,e.LAST_COMPATIBLE_COMPILER_REVISION=7,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};var c="[object Object]";function d(t,e,i){this.helpers=t||{},this.partials=e||{},this.decorators=i||{},n.registerDefaultHelpers(this),a.registerDefaultDecorators(this)}d.prototype={constructor:d,logger:l.default,log:l.default.log,registerHelper:function(t,e){if(o.toString.call(t)===c){if(e)throw new r.default("Arg not supported with multiple helpers");o.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if(o.toString.call(t)===c)o.extend(this.partials,t);else{if(void 0===e)throw new r.default('Attempting to register a partial called "'+t+'" as undefined');this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,e){if(o.toString.call(t)===c){if(e)throw new r.default("Arg not supported with multiple decorators");o.extend(this.decorators,t)}else this.decorators[t]=e},unregisterDecorator:function(t){delete this.decorators[t]},resetLoggedPropertyAccesses:function(){h.resetLoggedProperties()}};var u=l.default.log;e.log=u,e.createFrame=o.createFrame,e.logger=l.default},881:(t,e,i)=>{"use strict";e.__esModule=!0,e.registerDefaultDecorators=function(t){o.default(t)};var s,o=(s=i(670))&&s.__esModule?s:{default:s}},670:(t,e,i)=>{"use strict";e.__esModule=!0;var s=i(392);e.default=function(t){t.registerDecorator("inline",(function(t,e,i,o){var r=t;return e.partials||(e.partials={},r=function(o,r){var n=i.partials;i.partials=s.extend({},n,e.partials);var a=t(o,r);return i.partials=n,a}),e.partials[o.args[0]]=o.fn,r}))},t.exports=e.default},728:(t,e)=>{"use strict";e.__esModule=!0;var i=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function s(t,e){var o=e&&e.loc,r=void 0,n=void 0,a=void 0,l=void 0;o&&(r=o.start.line,n=o.end.line,a=o.start.column,l=o.end.column,t+=" - "+r+":"+a);for(var h=Error.prototype.constructor.call(this,t),c=0;c<i.length;c++)this[i[c]]=h[i[c]];Error.captureStackTrace&&Error.captureStackTrace(this,s);try{o&&(this.lineNumber=r,this.endLineNumber=n,Object.defineProperty?(Object.defineProperty(this,"column",{value:a,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:l,enumerable:!0})):(this.column=a,this.endColumn=l))}catch(t){}}s.prototype=new Error,e.default=s,t.exports=e.default},638:(t,e,i)=>{"use strict";function s(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.registerDefaultHelpers=function(t){o.default(t),r.default(t),n.default(t),a.default(t),l.default(t),h.default(t),c.default(t)},e.moveHelperToHooks=function(t,e,i){t.helpers[e]&&(t.hooks[e]=t.helpers[e],i||delete t.helpers[e])};var o=s(i(342)),r=s(i(822)),n=s(i(905)),a=s(i(405)),l=s(i(702)),h=s(i(593)),c=s(i(978))},342:(t,e,i)=>{"use strict";e.__esModule=!0;var s=i(392);e.default=function(t){t.registerHelper("blockHelperMissing",(function(e,i){var o=i.inverse,r=i.fn;if(!0===e)return r(this);if(!1===e||null==e)return o(this);if(s.isArray(e))return e.length>0?(i.ids&&(i.ids=[i.name]),t.helpers.each(e,i)):o(this);if(i.data&&i.ids){var n=s.createFrame(i.data);n.contextPath=s.appendContextPath(i.data.contextPath,i.name),i={data:n}}return r(e,i)}))},t.exports=e.default},822:(t,e,i)=>{"use strict";e.__esModule=!0;var s,o=i(392),r=(s=i(728))&&s.__esModule?s:{default:s};e.default=function(t){t.registerHelper("each",(function(t,e){if(!e)throw new r.default("Must pass iterator to #each");var s,n=e.fn,a=e.inverse,l=0,h="",c=void 0,d=void 0;function u(e,i,s){c&&(c.key=e,c.index=i,c.first=0===i,c.last=!!s,d&&(c.contextPath=d+e)),h+=n(t[e],{data:c,blockParams:o.blockParams([t[e],e],[d+e,null])})}if(e.data&&e.ids&&(d=o.appendContextPath(e.data.contextPath,e.ids[0])+"."),o.isFunction(t)&&(t=t.call(this)),e.data&&(c=o.createFrame(e.data)),t&&"object"==typeof t)if(o.isArray(t))for(var f=t.length;l<f;l++)l in t&&u(l,l,l===t.length-1);else if(i.g.Symbol&&t[i.g.Symbol.iterator]){for(var p=[],m=t[i.g.Symbol.iterator](),g=m.next();!g.done;g=m.next())p.push(g.value);for(f=(t=p).length;l<f;l++)u(l,l,l===t.length-1)}else s=void 0,Object.keys(t).forEach((function(t){void 0!==s&&u(s,l-1),s=t,l++})),void 0!==s&&u(s,l-1,!0);return 0===l&&(h=a(this)),h}))},t.exports=e.default},905:(t,e,i)=>{"use strict";e.__esModule=!0;var s,o=(s=i(728))&&s.__esModule?s:{default:s};e.default=function(t){t.registerHelper("helperMissing",(function(){if(1!==arguments.length)throw new o.default('Missing helper: "'+arguments[arguments.length-1].name+'"')}))},t.exports=e.default},405:(t,e,i)=>{"use strict";e.__esModule=!0;var s,o=i(392),r=(s=i(728))&&s.__esModule?s:{default:s};e.default=function(t){t.registerHelper("if",(function(t,e){if(2!=arguments.length)throw new r.default("#if requires exactly one argument");return o.isFunction(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||o.isEmpty(t)?e.inverse(this):e.fn(this)})),t.registerHelper("unless",(function(e,i){if(2!=arguments.length)throw new r.default("#unless requires exactly one argument");return t.helpers.if.call(this,e,{fn:i.inverse,inverse:i.fn,hash:i.hash})}))},t.exports=e.default},702:(t,e)=>{"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("log",(function(){for(var e=[void 0],i=arguments[arguments.length-1],s=0;s<arguments.length-1;s++)e.push(arguments[s]);var o=1;null!=i.hash.level?o=i.hash.level:i.data&&null!=i.data.level&&(o=i.data.level),e[0]=o,t.log.apply(t,e)}))},t.exports=e.default},593:(t,e)=>{"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("lookup",(function(t,e,i){return t?i.lookupProperty(t,e):t}))},t.exports=e.default},978:(t,e,i)=>{"use strict";e.__esModule=!0;var s,o=i(392),r=(s=i(728))&&s.__esModule?s:{default:s};e.default=function(t){t.registerHelper("with",(function(t,e){if(2!=arguments.length)throw new r.default("#with requires exactly one argument");o.isFunction(t)&&(t=t.call(this));var i=e.fn;if(o.isEmpty(t))return e.inverse(this);var s=e.data;return e.data&&e.ids&&((s=o.createFrame(e.data)).contextPath=o.appendContextPath(e.data.contextPath,e.ids[0])),i(t,{data:s,blockParams:o.blockParams([t],[s&&s.contextPath])})}))},t.exports=e.default},572:(t,e,i)=>{"use strict";e.__esModule=!0,e.createNewLookupObject=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return s.extend.apply(void 0,[Object.create(null)].concat(e))};var s=i(392)},293:(t,e,i)=>{"use strict";e.__esModule=!0,e.createProtoAccessControl=function(t){var e=Object.create(null);e.constructor=!1,e.__defineGetter__=!1,e.__defineSetter__=!1,e.__lookupGetter__=!1;var i=Object.create(null);return i.__proto__=!1,{properties:{whitelist:s.createNewLookupObject(i,t.allowedProtoProperties),defaultValue:t.allowProtoPropertiesByDefault},methods:{whitelist:s.createNewLookupObject(e,t.allowedProtoMethods),defaultValue:t.allowProtoMethodsByDefault}}},e.resultIsAllowed=function(t,e,i){return function(t,e){return void 0!==t.whitelist[e]?!0===t.whitelist[e]:void 0!==t.defaultValue?t.defaultValue:(function(t){!0!==r[t]&&(r[t]=!0,o.log("error",'Handlebars: Access has been denied to resolve the property "'+t+'" because it is not an "own property" of its parent.\nYou can add a runtime option to disable the check or this warning:\nSee https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details'))}(e),!1)}("function"==typeof t?e.methods:e.properties,i)},e.resetLoggedProperties=function(){Object.keys(r).forEach((function(t){delete r[t]}))};var s=i(572),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(37)),r=Object.create(null)},5:(t,e)=>{"use strict";e.__esModule=!0,e.wrapHelper=function(t,e){return"function"!=typeof t?t:function(){var i=arguments[arguments.length-1];return arguments[arguments.length-1]=e(i),t.apply(this,arguments)}}},37:(t,e,i)=>{"use strict";e.__esModule=!0;var s=i(392),o={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(t){if("string"==typeof t){var e=s.indexOf(o.methodMap,t.toLowerCase());t=e>=0?e:parseInt(t,10)}return t},log:function(t){if(t=o.lookupLevel(t),"undefined"!=typeof console&&o.lookupLevel(o.level)<=t){var e=o.methodMap[t];console[e]||(e="log");for(var i=arguments.length,s=Array(i>1?i-1:0),r=1;r<i;r++)s[r-1]=arguments[r];console[e].apply(console,s)}}};e.default=o,t.exports=e.default},982:(t,e,i)=>{"use strict";e.__esModule=!0,e.default=function(t){var e=void 0!==i.g?i.g:window,s=e.Handlebars;t.noConflict=function(){return e.Handlebars===t&&(e.Handlebars=s),t}},t.exports=e.default},628:(t,e,i)=>{"use strict";e.__esModule=!0,e.checkRevision=function(t){var e=t&&t[0]||1,i=n.COMPILER_REVISION;if(!(e>=n.LAST_COMPATIBLE_COMPILER_REVISION&&e<=n.COMPILER_REVISION)){if(e<n.LAST_COMPATIBLE_COMPILER_REVISION){var s=n.REVISION_CHANGES[i],o=n.REVISION_CHANGES[e];throw new r.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+s+") or downgrade your runtime to an older version ("+o+").")}throw new r.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}},e.template=function(t,e){if(!e)throw new r.default("No environment passed to template");if(!t||!t.main)throw new r.default("Unknown template object: "+typeof t);t.main.decorator=t.main_d,e.VM.checkRevision(t.compiler);var i=t.compiler&&7===t.compiler[0],s={strict:function(t,e,i){if(!t||!(e in t))throw new r.default('"'+e+'" not defined in '+t,{loc:i});return t[e]},lookupProperty:function(t,e){var i=t[e];return null==i||Object.prototype.hasOwnProperty.call(t,e)||h.resultIsAllowed(i,s.protoAccessControl,e)?i:void 0},lookup:function(t,e){for(var i=t.length,o=0;o<i;o++)if(null!=(t[o]&&s.lookupProperty(t[o],e)))return t[o][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:o.escapeExpression,invokePartial:function(i,s,n){n.hash&&(s=o.extend({},s,n.hash),n.ids&&(n.ids[0]=!0)),i=e.VM.resolvePartial.call(this,i,s,n);var a=o.extend({},n,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),l=e.VM.invokePartial.call(this,i,s,a);if(null==l&&e.compile&&(n.partials[n.name]=e.compile(i,t.compilerOptions,e),l=n.partials[n.name](s,a)),null!=l){if(n.indent){for(var h=l.split("\n"),c=0,d=h.length;c<d&&(h[c]||c+1!==d);c++)h[c]=n.indent+h[c];l=h.join("\n")}return l}throw new r.default("The partial "+n.name+" could not be compiled when running in runtime-only mode")},fn:function(e){var i=t[e];return i.decorator=t[e+"_d"],i},programs:[],program:function(t,e,i,s,o){var r=this.programs[t],n=this.fn(t);return e||o||s||i?r=c(this,t,n,e,i,s,o):r||(r=this.programs[t]=c(this,t,n)),r},data:function(t,e){for(;t&&e--;)t=t._parent;return t},mergeIfNeeded:function(t,e){var i=t||e;return t&&e&&t!==e&&(i=o.extend({},e,t)),i},nullContext:Object.seal({}),noop:e.VM.noop,compilerInfo:t.compiler};function n(e){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=i.data;n._setup(i),!i.partial&&t.useData&&(o=u(e,o));var r=void 0,a=t.useBlockParams?[]:void 0;function l(e){return""+t.main(s,e,s.helpers,s.partials,o,a,r)}return t.useDepths&&(r=i.depths?e!=i.depths[0]?[e].concat(i.depths):i.depths:[e]),(l=f(t.main,l,s,i.depths||[],o,a))(e,i)}return n.isTop=!0,n._setup=function(r){if(r.partial)s.protoAccessControl=r.protoAccessControl,s.helpers=r.helpers,s.partials=r.partials,s.decorators=r.decorators,s.hooks=r.hooks;else{var n=o.extend({},e.helpers,r.helpers);!function(t,e){Object.keys(t).forEach((function(i){var s=t[i];t[i]=function(t,e){var i=e.lookupProperty;return l.wrapHelper(t,(function(t){return o.extend({lookupProperty:i},t)}))}(s,e)}))}(n,s),s.helpers=n,t.usePartial&&(s.partials=s.mergeIfNeeded(r.partials,e.partials)),(t.usePartial||t.useDecorators)&&(s.decorators=o.extend({},e.decorators,r.decorators)),s.hooks={},s.protoAccessControl=h.createProtoAccessControl(r);var c=r.allowCallsToHelperMissing||i;a.moveHelperToHooks(s,"helperMissing",c),a.moveHelperToHooks(s,"blockHelperMissing",c)}},n._child=function(e,i,o,n){if(t.useBlockParams&&!o)throw new r.default("must pass block params");if(t.useDepths&&!n)throw new r.default("must pass parent depths");return c(s,e,t[e],i,0,o,n)},n},e.wrapProgram=c,e.resolvePartial=function(t,e,i){return t?t.call||i.name||(i.name=t,t=i.partials[t]):t="@partial-block"===i.name?i.data["partial-block"]:i.partials[i.name],t},e.invokePartial=function(t,e,i){var s=i.data&&i.data["partial-block"];i.partial=!0,i.ids&&(i.data.contextPath=i.ids[0]||i.data.contextPath);var a=void 0;if(i.fn&&i.fn!==d&&function(){i.data=n.createFrame(i.data);var t=i.fn;a=i.data["partial-block"]=function(e){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return i.data=n.createFrame(i.data),i.data["partial-block"]=s,t(e,i)},t.partials&&(i.partials=o.extend({},i.partials,t.partials))}(),void 0===t&&a&&(t=a),void 0===t)throw new r.default("The partial "+i.name+" could not be found");if(t instanceof Function)return t(e,i)},e.noop=d;var s,o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(392)),r=(s=i(728))&&s.__esModule?s:{default:s},n=i(67),a=i(638),l=i(5),h=i(293);function c(t,e,i,s,o,r,n){function a(e){var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=n;return!n||e==n[0]||e===t.nullContext&&null===n[0]||(a=[e].concat(n)),i(t,e,t.helpers,t.partials,o.data||s,r&&[o.blockParams].concat(r),a)}return(a=f(i,a,t,n,s,r)).program=e,a.depth=n?n.length:0,a.blockParams=o||0,a}function d(){return""}function u(t,e){return e&&"root"in e||((e=e?n.createFrame(e):{}).root=t),e}function f(t,e,i,s,r,n){if(t.decorator){var a={};e=t.decorator(e,a,i,s&&s[0],r,n,s),o.extend(e,a)}return e}},558:(t,e)=>{"use strict";function i(t){this.string=t}e.__esModule=!0,i.prototype.toString=i.prototype.toHTML=function(){return""+this.string},e.default=i,t.exports=e.default},392:(t,e)=>{"use strict";e.__esModule=!0,e.extend=n,e.indexOf=function(t,e){for(var i=0,s=t.length;i<s;i++)if(t[i]===e)return i;return-1},e.escapeExpression=function(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return o.test(t)?t.replace(s,r):t},e.isEmpty=function(t){return!t&&0!==t||!(!h(t)||0!==t.length)},e.createFrame=function(t){var e=n({},t);return e._parent=t,e},e.blockParams=function(t,e){return t.path=e,t},e.appendContextPath=function(t,e){return(t?t+".":"")+e};var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},s=/[&<>"'`=]/g,o=/[&<>"'`=]/;function r(t){return i[t]}function n(t){for(var e=1;e<arguments.length;e++)for(var i in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],i)&&(t[i]=arguments[e][i]);return t}var a=Object.prototype.toString;e.toString=a;var l=function(t){return"function"==typeof t};l(/x/)&&(e.isFunction=l=function(t){return"function"==typeof t&&"[object Function]"===a.call(t)}),e.isFunction=l;var h=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===a.call(t)};e.isArray=h},202:(t,e,i)=>{t.exports=i(834).default}},e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={exports:{}};return t[s](o,o.exports,i),o.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";class t extends HTMLElement{constructor(){super(),this.checkedAttributes=new Map}static get observedAttributes(){return[]}createShadowDom(t="",e=""){this.attachShadow({mode:"open"}),""!==t&&(t=`<style>${t}</style>`),this.shadowRoot.innerHTML=`${t}${e}`}handleAttributesChange(){}attributeChangedCallback(t,e,i){let s="";this.checkedAttributes.has(t)?s=this.checkedAttributes.get(t):(s="handle"+t.split("-").map((t=>t.substr(0,1).toUpperCase()+t.substr(1))).join("")+"Change",s in this||(s=""),this.checkedAttributes.set(t,s)),""!==s&&this[s](),this.handleAttributesChange()}}class e{constructor(t,e){this.nextRenderId=0,this.started=!1,this.nextFrameTime=0,this.needRender=!1,this.bgImage=null,this.bgColor="",this.globalOpacity=0,this.glowTime=0,this.renderList=t,this.context=e,this.requestNextRender=window.requestAnimationFrame,this.renderCallback=this.render.bind(this),this.renderObservers=new Set,this.nextRenderHandlers=new Set}get canvas(){return this.context.canvas}get backgroundColor(){return this.bgColor}set backgroundColor(t){this.bgColor=t,this.requestRender()}setBackgroundImage(t){return""===t?(this.bgImage=null,this.requestRender(),Promise.resolve()):new Promise((e=>{const i=new Image;i.addEventListener("load",(()=>{this.bgImage=i,this.requestRender(),e()})),i.crossOrigin="anonymous",i.src=t}))}useGlowTail(){if(this.glowCanvas)return;const t=this.context.canvas;this.glowCanvas=document.createElement("canvas"),this.glowCanvas.width=t.width,this.glowCanvas.height=t.height,this.glowCanvasContext=this.glowCanvas.getContext("2d")}start(){return this.started&&this.finish(),this.glowTime=0,this.globalOpacity=0,this.started=!0,this.render(),this}finish(){return this.started=!1,window.cancelAnimationFrame(this.nextRenderId),this}observe(t){this.renderObservers.add(t)}requestRender(t=null){this.needRender=!0,null!==t&&this.nextRenderHandlers.add(t)}render(){const t=Date.now();if(this.nextRenderId=this.requestNextRender.call(window,this.renderCallback),t<this.nextFrameTime)return;this.nextFrameTime=t+41,this.renderList.interrupt(),this.nextRenderHandlers.size>0&&(this.nextRenderHandlers.forEach((t=>t())),this.nextRenderHandlers.clear());const e=this.context.canvas;!this.renderList.needRender&&!this.needRender&&this.globalOpacity>=1&&0===this.glowTime||(this.globalOpacity<1&&(this.globalOpacity+=.1),this.prepareCanvasBeforeRender(),(this.renderList.needRender||this.needRender)&&this.glowCanvas&&(this.glowTime=5),this.context.globalAlpha=this.globalOpacity,this.bgColor&&(this.context.fillStyle=this.bgColor,this.context.fillRect(0,0,e.width,e.height)),this.drawBgImage(),this.needRender=!1,this.renderList.render(this.context),this.renderObservers.size>0&&this.renderObservers.forEach((t=>t())))}prepareCanvasBeforeRender(){const t=this.context.canvas;this.glowCanvasContext&&this.glowTime>1?(this.glowCanvas.width===t.width&&this.glowCanvas.height===t.height||(this.glowCanvas.width=t.width,this.glowCanvas.height=t.height),this.glowCanvasContext.clearRect(0,0,t.width,t.height),this.glowCanvasContext.drawImage(t,0,0),this.context.clearRect(0,0,t.width,t.height),this.context.globalAlpha=.5,this.context.drawImage(this.glowCanvas,0,0),this.context.globalAlpha=1,this.glowTime--):this.context.clearRect(0,0,t.width,t.height)}drawBgImage(){if(!this.bgImage||!this.bgImage.complete||0===this.bgImage.naturalWidth)return;const t=this.bgImage.naturalWidth,e=this.canvas.height-this.bgImage.naturalHeight,i=Math.ceil(this.canvas.width/t);for(let s=0;s<i;s++)this.context.drawImage(this.bgImage,s*t,e)}}class s{constructor(){this.isChangedByInterruption=!1,this.isChangedList=!1,this.list=new Set,this.waitList=new Set,this.beforeRenderCallbacks=new WeakMap,this.afterRenderCallbacks=new WeakMap}clear(){this.list.clear(),this.waitList.clear(),this.isChangedList=!0}add(t,e=0,i=null,s=null){return e>0?this.waitList.add({element:t,wait:e}):this.list.add(t),"function"==typeof i&&this.beforeRenderCallbacks.set(t,i),"function"==typeof s&&this.afterRenderCallbacks.set(t,s),this.isChangedList=!0,this}remove(t){for(const e of this.waitList)if(e.element===t){this.waitList.delete(e);break}return this.list.delete(t),this.isChangedList=!0,this}getBoundingRect(){const t={x:Number.MAX_VALUE,y:Number.MAX_VALUE},e={x:0,y:0};for(const i of this.list){const{x:s,y:o,width:r,height:n}=i.getBoundingRect();t.x=Math.min(t.x,s),t.y=Math.min(t.y,o),e.x=Math.max(e.x,s+r),e.y=Math.max(e.y,o+n)}return{x:t.x,y:t.y,width:e.x-t.x,height:e.y-t.y}}getElementUnderPoint(t){for(const e of[...this.list].reverse()){const{x:i,y:s,width:o,height:r}=e.getBoundingRect();if(t.x>i&&t.x<i+o&&t.y>s&&t.y<s+r)return e}return null}get isEnded(){return!(this.waitList.size>0)&&(0===this.list.size||[...this.list].every((t=>t.isEnded)))}get needRender(){return this.isChangedByInterruption||this.isChangedList}interrupt(){let t=!1;for(const e of this.list)e.isEnded?(this.list.delete(e),t=!0):e.interrupt()&&(t=!0);for(const e of this.waitList)0==--e.wait&&(this.waitList.delete(e),this.list.add(e.element),t=!0);return this.isChangedByInterruption=t,t}render(t){this.isChangedList=!1,this.isChangedByInterruption=!1;for(const e of this.list)this.beforeRenderCallbacks.has(e)&&(t.save(),this.beforeRenderCallbacks.get(e)(t),t.restore()),t.save(),e.render(t),t.restore(),this.afterRenderCallbacks.has(e)&&(t.save(),this.afterRenderCallbacks.get(e)(t),t.restore())}}const o=Math.PI/180,r=180/Math.PI,n=2*Math.PI,a=Math.PI/2;function l(t,e=1,i=0){return Math.max(i,Math.max(i,t))}function h(t,e=0,i){return e+t*(i-e)}function c(t=1e3){return Math.round(Math.random()*t)/t}function d(t,e=0){return e+Math.random()*(t-e)}function u(t,e,i,s){const o=1-t,r=o**2,n=t**2;return{x:r*e.x+2*o*t*i.x+n*s.x,y:r*e.y+2*o*t*i.y+n*s.y}}const f=new Map;var p;!function(t){t.LAUNCH_1="launch-1.mp3",t.EXPLOSION_1="explosion-1.mp3",t.EXPLOSION_2="explosion-2.mp3",t.EXPLOSION_FIZZ="explosion-fizz.mp3"}(p||(p={}));let m=.3,g=!1;class w{constructor(t){this.fileName=t,this.wasPlayed=!1,this.canPlay=!0,this.isLoading=!1,this.filePath=w.assetsUrl+"/"+this.fileName,f.has(this.filePath)&&(this.audio=f.get(this.filePath).cloneNode(!0),this.audio.volume=m)}static get disabled(){return g}static set disabled(t){g=t}static muteAll(t){m=t?0:.3}play(){return!(!g&&!this.wasPlayed&&this.canPlay&&(this.isLoading||this.playWhenReady().then(),1))}preloadFile(){if(f.has(this.filePath))return;const t=new Audio;t.volume=m,t.autoplay=!1,t.src=this.filePath,f.set(this.filePath,t)}async playWhenReady(){g||(this.isLoading=!0,f.has(this.filePath)||this.preloadFile(),this.audio||(this.audio=f.get(this.filePath).cloneNode(!0)),this.audio.volume=m,this.wasPlayed=!0,await this.audio.play(),this.isLoading=!1)}}w.assetsUrl="./sounds";const v=["#ff5b5b","#ffd449","#c4ff21","#21ff60","#21f8ff","#41b4ff","#d466ff","#ff66c2","#ffffe7"],y="#fff",x=["#a95e47","#bca047","#819d4a","#7ed070","#73bbc8","#8a8bf5","#ab80bc","#ec2f8d","#acaca3"];function b(t,e=v){const i=[...e];t=Math.min(t,i.length);const s=[];for(;t-- >0;)s.push(i.splice(Math.round(1e3*Math.random())%i.length,1)[0]);return s}var M;!function(t){t[t.MIN_PEAKS=9]="MIN_PEAKS",t[t.MAX_PEAKS=15]="MAX_PEAKS",t[t.MIN_DISTANCE=20]="MIN_DISTANCE",t[t.MAX_DISTANCE=40]="MAX_DISTANCE"}(M||(M={}));class E{constructor(t){var e,i;this.sound=null,this.stage=0,this.opacity=1,this.angleStepDeg=0,this.glowRadius1=5,this.glowRadius2=10,this.pos=t.position||{x:0,y:0},this.color=(null==t?void 0:t.colors[0])||y,this.distance=h(null!==(e=t.sizeFactor)&&void 0!==e?e:.5,M.MIN_DISTANCE,M.MAX_DISTANCE),this.angleStepDeg=360/(2*h(null!==(i=t.elementsFactor)&&void 0!==i?i:.5,M.MIN_PEAKS,M.MAX_PEAKS)),t.noSound||(this.sound=new w(p.EXPLOSION_1))}getBoundingRect(){const t=this.distance>>1;return{x:this.pos.x-t,y:this.pos.y-t,width:this.distance,height:this.distance}}get isEnded(){return this.stage>=3}interrupt(){var t;if(!1===(null===(t=this.sound)||void 0===t?void 0:t.play()))return!1;switch(this.stage){case 0:this.pathGlow=this.generatePath(1,180*Math.random()),this.pathLight=this.generatePath(.5,180*Math.random()),this.glowRadius1=.3*this.distance,this.glowRadius2=.7*this.distance;break;case 1:this.pathGlow=this.generatePath(2,180*Math.random()),this.pathLight=this.generatePath(1,180*Math.random()),this.glowRadius1=.5*this.distance,this.glowRadius2=1.2*this.distance;break;case 2:this.pathGlow=null,this.pathLight=this.generatePath(.5,180*Math.random()),this.glowRadius1=this.distance,this.glowRadius2=2*this.distance,this.opacity=.4}return++this.stage,!0}render(t){if(t.translate(this.pos.x,this.pos.y),this.glowRadius2>0){const e=t.createRadialGradient(0,0,this.glowRadius1,0,0,this.glowRadius2);e.addColorStop(0,"rgba(255, 255, 255, 0.3)"),e.addColorStop(1,"rgba(255, 255, 255, 0)"),t.globalAlpha=this.opacity,t.fillStyle=e,t.fillRect(-this.glowRadius2,-this.glowRadius2,this.glowRadius2<<1,this.glowRadius2<<1)}this.pathGlow&&(t.fillStyle=this.color,t.globalAlpha=.7*this.opacity,E.drawPath(this.pathGlow,t)),this.pathLight&&(t.fillStyle="#ffffff",t.globalAlpha=this.opacity,E.drawPath(this.pathLight,t))}static drawPath(t,e){e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let i=1;i<t.length;i++)e.lineTo(t[i].x,t[i].y);e.closePath(),e.fill()}generatePath(t,e=0){const i=this.distance*t,s=.3*i,r=Math.floor(360/this.angleStepDeg),n=[];for(let t=0;t<r;t++){let r=e+this.angleStepDeg*t;r+=this.angleStepDeg*(.3*Math.random()-.3),r*=o;let a=1==(1&t)?s:i;a*=.4+.6*Math.random(),n.push({x:a*Math.cos(r),y:a*Math.sin(r)})}return n}}const k=.05;class S{constructor(t=20,e=2){this.length=t,this.pointSize=e,this.points=[],this.halfSize=e/2,this.opacityStep=1/t}addPoint(t){if(0===this.points.length)return this.points.push({...t,opacity:1}),this;const e=this.points[0],i=t.x-e.x,s=t.y-e.y,o=Math.ceil(Math.max(Math.abs(i),Math.abs(s))/this.pointSize);if(o<=1)return this.points.unshift({...t,opacity:1}),this;const r=i/o,n=s/o,a=(1-e.opacity)/o;for(let t=1;t<=o;t++)this.points.unshift({x:e.x+r*t,y:e.y+n*t,opacity:e.opacity+a*t});return this}getBoundingRect(){const t={x:Number.MAX_VALUE,y:Number.MAX_VALUE},e={x:0,y:0};for(const i of this.points)t.x=Math.min(t.x,i.x),t.y=Math.min(t.y,i.y),e.x=Math.max(e.x,i.x),e.y=Math.max(e.y,i.y);return{x:t.x,y:t.y,width:e.x-t.x,height:e.y-t.y}}get isEnded(){for(const t of this.points)if(t.opacity>k)return!1;return!0}interrupt(){this.points.length>300&&this.points.splice(200);for(const t of this.points){if(t.opacity<=k)break;t.opacity/=2}return!0}render(t){let e=1;for(let i=0;i<this.points.length&&i<this.length;i++){const s=this.points[i];if(s.opacity<=k)break;t.globalAlpha=e>s.opacity?s.opacity:e,t.fillRect(s.x-this.halfSize,s.y-this.halfSize,this.pointSize,this.pointSize),e-=this.opacityStep}}}class C{constructor(t,e,i){var s,o;this.distance=e,this.sound=null,this.time=0,this.value=0,this.duration=0,this.opacity=1,this.elements=[],this.colors=t.colors||[y],this.pos={...t.position||{x:0,y:0}},this.elements=this.generateElements(i),this.explosionType0=new E({colors:[this.colors[0]],position:this.pos,sizeFactor:null!==(s=t.sizeFactor)&&void 0!==s?s:.5,elementsFactor:null!==(o=t.elementsFactor)&&void 0!==o?o:.5,noSound:!0}),t.noSound||(this.sound=new w(p.EXPLOSION_2))}getRandomColor(){return this.colors[Math.ceil(1e3*Math.random())%this.colors.length]}getBoundingRect(){const t=this.distance>>1;return{x:this.pos.x-t,y:this.pos.y-t,width:this.distance,height:this.distance}}get isEnded(){var t,e;if(this.time<this.duration)return!1;for(const e of this.elements)if(!1===(null===(t=e.tail)||void 0===t?void 0:t.isEnded))return!1;return!1!==(null===(e=this.explosionType0)||void 0===e?void 0:e.isEnded)}interrupt(){var t,e,i,s;if(!1===(null===(t=this.sound)||void 0===t?void 0:t.play()))return!1;for(const t of this.elements)null===(e=t.tail)||void 0===e||e.interrupt();if(this.explosionType0&&(this.explosionType0.isEnded?this.explosionType0=null:this.explosionType0.interrupt()),this.time>=this.duration)return!0;this.value=1===(s=Math.min(1,this.time/this.duration))?1:1-Math.pow(2,-10*s);const o=1*this.time;for(const t of this.elements){const e=this.value*t.distance;t.x=t.xFactor*e+t.xFactor*o,t.y=t.yFactor*e+o,null===(i=t.tail)||void 0===i||i.addPoint({x:t.x,y:t.y})}return this.time>=this.duration-10&&(this.opacity=(this.duration-this.time)/10),++this.time,!0}render(t){var e;if(t.save(),t.translate(this.pos.x,this.pos.y),this.time<this.duration){t.globalAlpha=.3*this.opacity;for(const e of this.elements)t.fillStyle=e.color,t.beginPath(),t.arc(e.x,e.y,6,0,n),t.fill()}for(const i of this.elements)t.fillStyle=i.color,null===(e=i.tail)||void 0===e||e.render(t);if(this.time<this.duration){t.globalAlpha=this.opacity,t.fillStyle="#fff";for(const e of this.elements)t.fillRect(e.x-1,e.y-1,2,2)}t.restore(),this.explosionType0&&this.explosionType0.render(t)}}var _;!function(t){t[t.MIN_ELEMENTS=10]="MIN_ELEMENTS",t[t.MAX_ELEMENTS=50]="MAX_ELEMENTS",t[t.MIN_DISTANCE=100]="MIN_DISTANCE",t[t.MAX_DISTANCE=300]="MAX_DISTANCE"}(_||(_={}));class A extends C{constructor(t){var e,i;super(t,h(null!==(e=t.sizeFactor)&&void 0!==e?e:.5,_.MIN_DISTANCE,_.MAX_DISTANCE),h(null!==(i=t.elementsFactor)&&void 0!==i?i:.5,_.MIN_ELEMENTS,_.MAX_ELEMENTS)),this.duration=15}generateElements(t){let e=0;const i=360/t,s=[];for(let r=0;r<t;r++)e=i*r,e+=i*(.4*Math.random()*2-.4),e*=o,s.push({distance:this.distance*(.5+.5*Math.random()),xFactor:Math.cos(e),yFactor:Math.sin(e),tail:new S(30,2).addPoint({x:0,y:0}),color:this.getRandomColor(),x:0,y:0});return s}}var P,T,I;!function(t){t[t.MIN_ELEMENTS=15]="MIN_ELEMENTS",t[t.MAX_ELEMENTS=30]="MAX_ELEMENTS",t[t.MIN_DISTANCE=130]="MIN_DISTANCE",t[t.MAX_DISTANCE=300]="MAX_DISTANCE"}(P||(P={}));class L extends C{constructor(t){var e,i;super(t,h(null!==(e=t.sizeFactor)&&void 0!==e?e:.5,P.MIN_DISTANCE,P.MAX_DISTANCE),h(null!==(i=t.elementsFactor)&&void 0!==i?i:.5,P.MIN_ELEMENTS,P.MAX_ELEMENTS)),this.duration=20}generateElements(t){const e=[],i=Math.PI/t;let s=0;for(let o=0;o<t;o++){const r=i*o,n=Math.cos(r),a=Math.sin(r),l=Math.max(1,Math.ceil(t*a)),h=Math.PI/l;for(let t=0;t<l;t++){let i=a*Math.cos(h*t);i+=.02*Math.random()*2-.02;const o=n+(.02*Math.random()*2-.02),r=++s%3==0;e.push({x:0,y:0,distance:this.distance*(.05*Math.random()*2-.05+1),xFactor:i,yFactor:o,color:this.getRandomColor(),tail:r?new S(9,2).addPoint({x:0,y:0}):null})}}return e}}!function(t){t[t.MIN_ELEMENTS=30]="MIN_ELEMENTS",t[t.MAX_ELEMENTS=60]="MAX_ELEMENTS",t[t.MIN_DISTANCE=200]="MIN_DISTANCE",t[t.MAX_DISTANCE=300]="MAX_DISTANCE"}(T||(T={}));class F extends C{constructor(t){var e,i;super(t,h(null!==(e=t.sizeFactor)&&void 0!==e?e:.5,T.MIN_DISTANCE,T.MAX_DISTANCE),h(null!==(i=t.elementsFactor)&&void 0!==i?i:.5,T.MIN_ELEMENTS,T.MAX_ELEMENTS)),this.duration=15}generateElements(t){let e=0;const i=360/t,s=[],r=Math.random()*n,a=Math.cos(r),l=Math.sin(r);for(let r=0;r<t;r++){e=i*r,e+=i*(.1*Math.random()*2-.1),e*=o;let t=Math.cos(e),n=Math.sin(e)/5;s.push({distance:this.distance,xFactor:t*a-n*l,yFactor:t*l+n*a,tail:new S(6,2).addPoint({x:0,y:0}),color:this.getRandomColor(),x:0,y:0})}return s}}!function(t){t[t.MIN_ELEMENTS=15]="MIN_ELEMENTS",t[t.MAX_ELEMENTS=50]="MAX_ELEMENTS",t[t.MIN_DISTANCE=100]="MIN_DISTANCE",t[t.MAX_DISTANCE=300]="MAX_DISTANCE"}(I||(I={}));class N{constructor(t){var e,i;this.time=0,this.points=[],this.pos=t.position||{x:0,y:0},this.color=t.colors[0]||y,this.elementsCount=h(null!==(e=t.elementsFactor)&&void 0!==e?e:.5,I.MIN_ELEMENTS,I.MAX_ELEMENTS),this.distance=h(null!==(i=t.sizeFactor)&&void 0!==i?i:.5,I.MIN_DISTANCE,I.MAX_DISTANCE)}getBoundingRect(){const t=this.distance>>1;return{x:this.pos.x-t,y:this.pos.y-t,width:this.distance,height:this.distance}}get isEnded(){return this.elementsCount<=0}interrupt(){this.points=[];for(let t=0;t<this.elementsCount;t++){const t=Math.random()*n,e=Math.random()*this.distance;this.points.push({x:Math.cos(t)*e,y:Math.sin(t)*e})}return this.pos.y+=2,this.elementsCount-=2,!0}render(t){t.translate(this.pos.x,this.pos.y),t.globalAlpha=.5,t.fillStyle=this.color;for(const e of this.points)t.fillRect(e.x-1,e.y-4,2,8),t.fillRect(e.x-4,e.y-1,8,2);t.fillStyle="#fff",t.globalAlpha=1;for(const e of this.points)t.fillRect(e.x-1,e.y-1,2,2)}}const R=Math.ceil(12),O="#fff8df";var H;!function(t){t[t.WAIT=0]="WAIT",t[t.INCREASE_SPARK=1]="INCREASE_SPARK",t[t.LAUNCH=2]="LAUNCH",t[t.EXPLOSION=3]="EXPLOSION"}(H||(H={}));class B{constructor(t,e=null,i=0,s=4,o=10,r=15){this.canvas=e,this.angle=i,this.width=s,this.height=o,this.duration=r,this.sparks=[],this.time=0,this.stage=H.WAIT,this.sparkValue=0,this.prevValue=0,this.opacity=1,this.canBeLaunched=!0,this.pos=t.position||{x:0,y:0},this.fromPos={...this.pos},this.widthHalf=this.width/2,this.widthQuarter=this.width/4,this.heightHalf=this.height/2,this.heightQuarter=this.height/4,this.tail=new S(60,2),this.generateFinalPos(),this.generateAnchorPos(),"function"==typeof t.onLaunch&&(this.launchCallback=t.onLaunch),!1===t.canBeLaunched&&(this.canBeLaunched=!1),!0===t.autoLaunch&&this.launch(),!0===t.rocketFading&&(this.opacity=0)}getBoundingRect(){return{x:this.pos.x-(this.width<<1),y:this.pos.y-(this.height<<1),width:this.width<<2,height:this.height<<2}}get isEnded(){return this.stage===H.EXPLOSION&&this.tail.isEnded}launch(){return this.canBeLaunched?(this.stage===H.WAIT&&(this.stage=H.INCREASE_SPARK),this.launchCallback&&this.launchCallback(),this):this}interrupt(){var t;return this.opacity<1&&(this.opacity=Math.min(1,this.opacity+.1)),this.stage===H.WAIT?this.opacity<1:!1!==(null===(t=this.sound)||void 0===t?void 0:t.play())&&(this.stage!==H.INCREASE_SPARK&&this.tail.interrupt(),this.moveRocket(),this.generateSparks(),!0)}render(t){this.stage>H.INCREASE_SPARK&&(t.save(),t.fillStyle=O,this.tail.render(t),t.restore()),this.stage!==H.EXPLOSION&&(t.translate(this.pos.x,this.pos.y),t.globalAlpha=this.opacity,t.rotate(this.angle*o),this.drawRocket(t),this.stage===H.INCREASE_SPARK&&(this.sparkValue+=.1,this.sparkValue>=1&&(this.sparkValue=1,this.stage=H.LAUNCH)),this.stage>H.WAIT&&this.drawSparks(t),this.drawWings(t))}moveRocket(){if(this.stage!==H.LAUNCH)return;if(++this.time,this.time>this.duration)return this.stage=H.EXPLOSION,void(this.finishCallback&&this.finishCallback(this.pos));let t=this.time/this.duration;var e;if(t=(e=t)*e*e,t>.2)for(let e=this.prevValue;e<t;e+=.05)this.tail.addPoint(u(e,this.fromPos,this.anchorPos,this.toPos));this.prevValue=t;const i=u(t,this.fromPos,this.anchorPos,this.toPos);var s,o;this.angle=(s=i,o=this.pos,-Math.atan2(o.x-s.x,o.y-s.y)*r),this.pos=i}generateSparks(){if([H.INCREASE_SPARK,H.LAUNCH].includes(this.stage)){this.sparks=[];for(let t=0;t<20;t++){const t=a+15*(2*Math.random()-1)*o;let e=4+.5*Math.random()*4;e*=this.sparkValue;let i=30*Math.random();i*=this.sparkValue;const s=Math.cos(t),r=Math.sin(t),n=-this.widthHalf+Math.random()*this.width;this.sparks.push({x1:i*s+n,y1:i*r,x2:(i+e)*s+n,y2:(i+e)*r})}}}drawSparks(t){this.sparkGradient||(this.sparkGradient=t.createLinearGradient(-this.widthHalf+this.widthQuarter,0,this.width-this.widthHalf,12),this.sparkGradient.addColorStop(0,O),this.sparkGradient.addColorStop(.2,"rgba(255, 248, 223, 0.8)"),this.sparkGradient.addColorStop(1,"rgba(255, 248, 223, 0)")),t.fillStyle=this.sparkGradient,t.fillRect(-this.widthHalf+this.widthQuarter,0,this.width-this.widthHalf,12*this.sparkValue),t.strokeStyle=O,t.beginPath();for(const e of this.sparks)t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2);t.stroke()}generateAnchorPos(){const t=a+this.angle*o,e=Math.max(200,Math.min(400,200-this.fromPos.y));this.anchorPos={x:this.fromPos.x-Math.cos(t)*e,y:this.fromPos.y-Math.sin(t)*e}}generateFinalPos(){if(!this.canvas)return void(this.toPos={x:0,y:0});const t=Math.max(100,this.fromPos.x-300),e=Math.min(this.canvas.width-100,this.fromPos.x+300),i=Math.min(300,this.canvas.height-100);this.toPos={x:t+Math.round(Math.random()*(e-t)),y:200+Math.round(Math.random()*(i-200))}}}const z="#0e0e0e";var D;!function(t){t[t.MIN_ANGLE=-45]="MIN_ANGLE",t[t.MAX_ANGLE=45]="MAX_ANGLE",t[t.MIN_SIZE=1]="MIN_SIZE",t[t.MAX_SIZE=1.5]="MAX_SIZE"}(D||(D={}));const X="#404040";var j,G,q,V;!function(t){t[t.MIN_ANGLE=-45]="MIN_ANGLE",t[t.MAX_ANGLE=45]="MAX_ANGLE",t[t.MIN_SIZE=1]="MIN_SIZE",t[t.MAX_SIZE=1.3]="MAX_SIZE"}(j||(j={})),function(t){t.TYPE0="type0",t.TYPE1_CIRCLE="type1-circle",t.TYPE1_SPHERE="type1-sphere",t.TYPE1_DISK="type1-disk",t.TYPE2="type2"}(G||(G={})),function(t){t.COMB1="comb1",t.COMB2="comb2",t.COMB3="comb3",t.COMB4="comb4",t.COMB5="comb5",t.COMB6="comb6"}(q||(q={})),function(t){t.TYPE0="type0",t.TYPE1="type1"}(V||(V={}));const U={[G.TYPE0]:E,[G.TYPE1_CIRCLE]:A,[G.TYPE1_SPHERE]:L,[G.TYPE1_DISK]:F,[G.TYPE2]:N,[q.COMB1]:class extends s{constructor(t){var e,i,s,o;super();const r=t.colors||b(1+Math.ceil(1e3*Math.random())%3),n=b(1)[0],a=new A({colors:r,position:t.position||{x:0,y:0},sizeFactor:null!==(e=t.sizeFactor)&&void 0!==e?e:.5,elementsFactor:null!==(i=t.elementsFactor)&&void 0!==i?i:.5});t.noSound||(a.sound=new w(p.EXPLOSION_FIZZ));const l=new N({colors:[n],position:t.position||{x:0,y:0},sizeFactor:null!==(s=t.sizeFactor)&&void 0!==s?s:.5,elementsFactor:null!==(o=t.elementsFactor)&&void 0!==o?o:.5});this.add(a),this.add(l,Math.round(10.5))}},[q.COMB2]:class extends s{constructor(t){var e,i,s;super();const o=t.colors||b(1+Math.ceil(1e3*Math.random())%2),r=h(null!==(e=t.sizeFactor)&&void 0!==e?e:.5,_.MIN_DISTANCE,_.MAX_DISTANCE),a=t.position||{x:0,y:0},l=new A({colors:o,position:a,sizeFactor:null!==(i=t.sizeFactor)&&void 0!==i?i:.5,elementsFactor:null!==(s=t.elementsFactor)&&void 0!==s?s:.5});this.add(l);const c=b(2);let d=Math.ceil(6);const u=r/2;for(let t=0;t<5;t++){const e=Math.random()*n,i=Math.random()*u,s=new E({colors:[c[t%2]],position:{x:a.x+Math.cos(e)*i,y:a.y+Math.sin(e)*i},sizeFactor:0,elementsFactor:0});this.add(s,d),d+=Math.ceil(3*Math.random())}}},[q.COMB3]:class extends s{constructor(t){var e,i,s,o;super();const r=t.colors||b(1+Math.ceil(1e3*Math.random())%3),n=t.colors||b(1+Math.ceil(1e3*Math.random())%2),a=new A({colors:r,position:t.position||{x:0,y:0},sizeFactor:null!==(e=t.sizeFactor)&&void 0!==e?e:.5,elementsFactor:null!==(i=t.elementsFactor)&&void 0!==i?i:.5});this.add(a);const l=new F({colors:n,position:t.position||{x:0,y:0},sizeFactor:null!==(s=t.sizeFactor)&&void 0!==s?s:.5,elementsFactor:null!==(o=t.elementsFactor)&&void 0!==o?o:.5});l.sound=null,this.add(l,2)}},[q.COMB4]:class extends s{constructor(t){var e;super();const i=t.colors||b(3),s=new E({colors:[i[0]],position:t.position||{x:0,y:0},sizeFactor:null!==(e=t.sizeFactor)&&void 0!==e?e:.5,elementsFactor:0});this.add(s);const o=h(t.sizeFactor,P.MIN_DISTANCE,P.MAX_DISTANCE)/2,r=t.position||{x:0,y:0};for(let e=0;e<i.length;e++){const s=Math.random()*n,a=Math.random()*o,l=new L({colors:[i[e]],position:{x:r.x+Math.cos(s)*a,y:r.y+Math.sin(s)*a},sizeFactor:t.sizeFactor,elementsFactor:t.elementsFactor});this.add(l,5+3*e)}}},[q.COMB5]:class extends s{constructor(t){var e,i,s;super();const o=t.colors||b(1+Math.ceil(1e3*Math.random())%3),r=new L({colors:o,position:t.position||{x:0,y:0},sizeFactor:null!==(e=t.sizeFactor)&&void 0!==e?e:.5,elementsFactor:null!==(i=t.elementsFactor)&&void 0!==i?i:.5});t.noSound||(r.sound=new w(p.EXPLOSION_FIZZ)),this.add(r);const n=new N({colors:["#ffffe7"],position:t.position||{x:0,y:0},sizeFactor:null!==(s=t.sizeFactor)&&void 0!==s?s:.5,elementsFactor:1});this.add(n,R)}},[q.COMB6]:class extends s{constructor(t){var e,i,s,o;super();const r=b(d(2,5)),n=new E({colors:[r[0]],position:t.position||{x:0,y:0},sizeFactor:null!==(e=t.sizeFactor)&&void 0!==e?e:.5,elementsFactor:null!==(i=t.elementsFactor)&&void 0!==i?i:.5});t.noSound||(n.sound=new w(p.EXPLOSION_2)),this.add(n);for(let e=0;e<r.length;e++){const i=new F({colors:[r[e]],position:t.position||{x:0,y:0},sizeFactor:(null!==(s=t.sizeFactor)&&void 0!==s?s:.5)*d(.6,1.2),elementsFactor:null!==(o=t.elementsFactor)&&void 0!==o?o:.5});i.sound=null,this.add(i,e)}}}},W={[V.TYPE0]:class extends B{constructor(t,e=null){var i,s;const o=h(null!==(i=t.sizeFactor)&&void 0!==i?i:.5,D.MIN_SIZE,D.MAX_SIZE);super(t,e,h(null!==(s=t.angleFactor)&&void 0!==s?s:.5,D.MIN_ANGLE,D.MAX_ANGLE),6*o,18*o),this.color=t.rocketColors&&t.rocketColors[0]||b(1,x)[0],t.noSound||(this.sound=new w(p.LAUNCH_1))}drawRocket(t){t.fillStyle=z,t.beginPath(),t.moveTo(-this.widthHalf,-this.height),t.lineTo(0,-this.height-this.width),t.lineTo(this.widthHalf,-this.height),t.lineTo(-this.widthHalf,-this.height),t.closePath(),t.fill(),t.fillStyle=this.color,t.strokeStyle="#404040",t.beginPath(),t.rect(-this.widthHalf,-this.height,this.width,this.height),t.closePath(),t.stroke(),t.fill(),t.fillStyle=z,t.fillRect(-this.widthHalf,-4,this.width,4),t.fillStyle="rgba(255, 255, 255, 0.3)",t.fillRect(-this.widthQuarter,-this.height,this.widthHalf,this.height),t.fillStyle="#999173",t.fillRect(-this.widthHalf,0,2,20)}drawWings(t){}},[V.TYPE1]:class extends B{constructor(t,e=null){var i,s;const o=h(null!==(i=t.sizeFactor)&&void 0!==i?i:.5,j.MIN_SIZE,j.MAX_SIZE);super(t,e,h(null!==(s=t.angleFactor)&&void 0!==s?s:.5,j.MIN_ANGLE,j.MAX_ANGLE),8*o,20*o),this.color1=t.rocketColors&&t.rocketColors[0]||b(1,x)[0],this.color2=t.rocketColors&&t.rocketColors[1]||b(1,x)[0],t.noSound||(this.sound=new w(p.LAUNCH_1))}drawRocket(t){t.fillStyle=this.color1,t.strokeStyle=X,t.beginPath(),t.moveTo(-this.widthHalf-this.widthQuarter,-this.height),t.lineTo(0,-this.height-this.width-this.widthQuarter),t.lineTo(this.widthHalf+this.widthQuarter,-this.height),t.lineTo(-this.widthHalf-this.widthQuarter,-this.height),t.closePath(),t.fill(),t.stroke(),t.beginPath(),t.rect(-this.widthHalf,-this.height,this.width,this.height),t.closePath(),t.fill(),t.fillStyle=this.color2,t.fillRect(-this.widthHalf,-this.height,this.width,this.heightQuarter),t.fillRect(-this.widthHalf,2*-this.heightQuarter,this.width,this.heightQuarter),t.fillStyle="#242424",t.fillRect(-this.widthHalf,-this.heightQuarter,this.width,this.heightQuarter),t.fillStyle="rgba(255, 255, 255, 0.3)",t.fillRect(-this.widthQuarter,-this.height,this.widthHalf,this.height),t.beginPath(),t.moveTo(-this.widthHalf+this.widthQuarter,-this.height),t.lineTo(0,-this.height-this.width-this.widthQuarter),t.lineTo(this.widthHalf-this.widthQuarter,-this.height),t.lineTo(-this.widthHalf+this.widthQuarter,-this.height),t.closePath(),t.fill(),t.fillStyle="#8c8468",t.fillRect(-this.widthHalf,0,2,25)}drawWings(t){t.fillStyle=this.color2,t.strokeStyle=X,t.beginPath(),t.moveTo(-this.width,this.heightQuarter),t.lineTo(-this.width,-this.heightQuarter),t.lineTo(-this.widthHalf,-this.heightHalf),t.lineTo(-this.widthHalf,this.heightQuarter),t.lineTo(-this.width,this.heightQuarter),t.fill(),t.stroke(),t.beginPath(),t.moveTo(this.width,this.heightQuarter),t.lineTo(this.width,-this.heightQuarter),t.lineTo(this.widthHalf,-this.heightHalf),t.lineTo(this.widthHalf,this.heightQuarter),t.lineTo(this.width,this.heightQuarter),t.fill(),t.stroke(),t.beginPath(),t.rect(-1,-this.heightHalf,2,this.heightHalf+this.heightQuarter),t.fill(),t.stroke()}}};class Q{createFirework(t,e){const i=[];let s;return Q.correctFireworkData(t),t.rocketType?(s=Q.createRocket(t,e),t.explosionType&&i.push(new Promise((e=>{s.finishCallback=i=>{e(Q.createExplosion({...t,position:i}))}})))):t.explosionType&&(s=Q.createExplosion(t)),s&&i.unshift(Promise.resolve(s)),i}getRandomFirework(t,e=!0){const i=[...Object.values(q)],s=[...Object.values(V)];return{explosionType:i[Math.floor(Math.random()*i.length)],rocketType:s[Math.floor(Math.random()*s.length)],sizeFactor:c(),elementsFactor:c(),angleFactor:c(),rocketFading:!0,canBeLaunched:!0,position:t,autoLaunch:e}}static createExplosion(t){const e=U[t.explosionType]||null;if(!e)throw new Error("Unknown type of explosion");return new e(t)}static createRocket(t,e){const i=W[t.rocketType]||null;if(!i)throw new Error("Unknown type of rocket");return new i(t,e)}static correctFireworkData(t){var e,i;void 0!==t.sizeFactor&&(t.sizeFactor=l(+t.sizeFactor)),void 0!==t.elementsFactor&&(t.elementsFactor=l(+t.elementsFactor)),void 0!==t.angleFactor&&(t.angleFactor=l(+t.angleFactor)),void 0===t.position||"number"==typeof(null===(e=t.position)||void 0===e?void 0:e.x)&&"number"==typeof(null===(i=t.position)||void 0===i?void 0:i.y)||delete t.position}}const Z="rgba(11, 17, 34, 0.9)";var Y=i(632),K=i.n(Y),$=i(541),J=i.n($);const tt="ny21_score",et="ny21_turnoff";class it{static isTurnedOff(){try{return"1"===window.localStorage.getItem(et)}catch(t){}return!1}static getBestScore(){try{let t=window.localStorage.getItem(tt);return null===t?0:Math.max(0,parseInt(t,10))}catch(t){return 0}}static setBestScore(t){try{window.localStorage.setItem(tt,`${t}`)}catch(t){}}static turnOffGame(){try{window.localStorage.setItem(et,"1")}catch(t){}}}const st="#game"===window.location.hash,ot=st?100:15e3;window.customElements.define("fw-game1-launcher",class extends t{constructor(){super(),this.timer=0,this.decisionTimer=0,this.shown=!1,this.game=null,this.reset=()=>{it.isTurnedOff()||null!==this.game||this.shown||(window.clearTimeout(this.timer),this.timer=window.setTimeout(this.showButton,ot))},this.showButton=()=>{null!==this.game||this.shown||(this.shown=!0,this.setAttribute("show",""),this.decisionTimer=window.setTimeout(this.hide,3e4))},this.hide=()=>{window.clearTimeout(this.decisionTimer),this.removeAttribute("show"),this.shown=!1}}static get observedAttributes(){return["assets-url","show","autostart"]}connectedCallback(){it.isTurnedOff()||Math.random()<=.3&&!st||(this.renderElement(),window.addEventListener("scroll",this.reset),document.addEventListener("keydown",this.reset),document.addEventListener("mousedown",this.reset),this.reset())}disconnectedCallback(){window.clearTimeout(this.decisionTimer),window.clearTimeout(this.timer),window.removeEventListener("scroll",this.reset),document.removeEventListener("keydown",this.reset),document.removeEventListener("mousedown",this.reset)}handleAutostartChange(){this.hasAttribute("autostart")&&(this.hide(),this.run())}renderElement(){this.createShadowDom(":host{display:block;position:fixed;z-index:var(--z-index, 100000);bottom:-200px;left:-200px;cursor:pointer;transform:scale(0);transition:transform 1.5s ease-in-out,bottom 1.5s ease-in-out,left 1.5s ease-in-out}:host([show]){bottom:0;left:0;transform:scale(1)}img{width:140px;max-width:20vw;margin-bottom:-2px;transform:scale(-1, 1);vertical-align:bottom}",J()({assetsUrl:this.getAttribute("assets-url")||"."})),this.onclick=this.run.bind(this)}run(){null===this.game&&(window.clearTimeout(this.timer),this.hide(),this.game=document.createElement("fw-game1"),this.game.setAttribute("assets-url",this.getAttribute("assets-url")||"."),document.body.appendChild(this.game))}});const rt="#fffae9",nt=n/10;class at extends t{constructor(){super(),this.reset=()=>{this.game.isStarted?this.stop():(this.fireworks.clear(),this.fw.removeAllFireworks(),this.timers.forEach((t=>clearTimeout(t))),this.timers.clear(),this.generateFireworks(),this.pickTargetFirework())},this.fireworks=new Set,this.timers=new Set,w.disabled=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,this.game={isStarted:!1,timer:0,firework:null,time:0,duration:200,lives:5,livesEffectTimer:0,score:0,scoreEffectTimer:0},this.wickPath=(()=>{const t=n/72,e=Math.PI/2;let i=1,s=4;const o=[];for(let r=e;r<n+e;r+=t)o.push({x:Math.cos(r)*i,y:Math.sin(r)*i}),i+=s,s*=.93;return o})()}static get observedAttributes(){return["assets-url"]}connectedCallback(){it.isTurnedOff()||(this.renderElement(),window.addEventListener("resize",this.reset),this.updateCounters(),this.generateFireworks(),this.pickTargetFirework())}disconnectedCallback(){window.removeEventListener("resize",this.reset)}start(){it.isTurnedOff()||this.game.isStarted||(this.game.lives=5,this.game.score=0,this.game.duration=200,this.updateCounters(),this.reset(),this.classList.add("game-started"),this.game.isStarted=!0,this.generateFireworks(),this.pickTargetFirework())}stop(){it.isTurnedOff()||this.game.isStarted&&(this.classList.remove("game-started"),this.livesEl.classList.remove("highlight"),this.scoreEl.classList.remove("highlight"),this.game.isStarted=!1,this.game.firework=null,this.updateCounters(),this.reset())}toggleMute(){this.classList.toggle("muted"),w.muteAll(this.classList.contains("muted"))}renderElement(){this.createShadowDom(":host{--snow-color: #b1bece;--snow-color-light: #ccd8ea;--snow-color-dark1: #7c92ac;--snow-color-dark2: #444f5f;--lives-color: #fa6476;--score-color: #fff7c1;display:block;font-family:Tahoma,Helvetica,Arial,sans-serif;color:var(--snow-color);font-size:14px;position:fixed;left:0;top:0;width:100%;height:100%;z-index:var(--z-index, 100000);touch-action:none}.close-button{position:absolute;top:30px;right:30px;cursor:pointer;transform:scale(0);opacity:0;animation-name:slow-show-up;animation-duration:.5s;animation-fill-mode:forwards;animation-timing-function:ease-in}.close-button svg{fill:var(--snow-color)}.close-button:hover svg{fill:var(--snow-color-light)}.close-button:active svg{fill:var(--snow-color-dark1)}.mute-button{position:absolute;top:80px;right:24px;cursor:pointer;transform:scale(0);opacity:0;animation-name:slow-show-up;animation-duration:.5s;animation-fill-mode:forwards;animation-timing-function:ease-in}.mute-button svg{fill:var(--snow-color)}.mute-button:hover svg{fill:var(--snow-color-light)}.mute-button:active svg{fill:var(--snow-color-dark1)}:host(.muted) .mute-button svg{fill:var(--lives-color)}:host(.muted) .mute-button:hover svg{fill:var(--lives-color)}:host(.muted) .mute-button:active svg{fill:var(--lives-color)}.turn-off-button{position:absolute;top:130px;right:30px;cursor:pointer;transform:scale(0);opacity:0;animation-name:slow-show-up;animation-duration:.5s;animation-fill-mode:forwards;animation-timing-function:ease-in}.mute-button[hidden]+.turn-off-button{top:80px}.turn-off-button svg{fill:var(--snow-color)}.turn-off-button:hover svg{fill:var(--snow-color-light)}.turn-off-button:active svg{fill:var(--snow-color-dark1)}.caption{position:absolute;width:100%;text-align:center;left:0;bottom:370px;user-select:none;opacity:0}:host(.game-started) .caption{transform:scale(0);opacity:0;animation-name:slow-show-up;animation-duration:.5s;animation-fill-mode:forwards;animation-timing-function:ease-in}.start-button{position:absolute;background-color:var(--snow-color);padding:8px 16px;border-radius:16px;color:var(--snow-color-dark2);border-bottom:3px solid var(--snow-color-dark1);cursor:pointer;user-select:none;left:50%;bottom:300px;margin-left:-60px;animation-delay:.5s;transform:scale(0);opacity:0;animation-name:slow-show-up;animation-duration:.5s;animation-fill-mode:forwards;animation-timing-function:ease-in}:host(.game-started) .start-button{transform:scale(1);opacity:1;animation-name:slow-hide-off;animation-delay:initial;animation-duration:.5s;animation-fill-mode:forwards;animation-timing-function:ease-out}.start-button:hover{background-color:var(--snow-color-light)}.start-button:active{margin-top:2px;border-bottom:1px solid var(--snow-color-dark2)}.lives{position:absolute;width:100px;left:50%;margin-left:-180px;bottom:300px;user-select:none;font-size:32px;display:flex;align-items:center;justify-content:flex-end;transition:margin-bottom .1s ease-in-out;opacity:0}:host(.game-started) .lives{transform:scale(0);opacity:0;animation-name:slow-show-up;animation-duration:.5s;animation-fill-mode:forwards;animation-timing-function:ease-in}.lives span{margin-left:10px}.lives svg{fill:var(--snow-color-dark1)}.lives.highlight{color:var(--lives-color);margin-bottom:-5px}.lives.highlight svg{fill:var(--lives-color)}.score{position:absolute;width:100px;left:50%;margin-left:80px;bottom:300px;user-select:none;font-size:32px;display:flex;align-items:center;transition:margin-bottom .1s ease-in-out;opacity:0}:host(.game-started) .score{transform:scale(0);opacity:0;animation-name:slow-show-up;animation-duration:.5s;animation-fill-mode:forwards;animation-timing-function:ease-in}.score span{margin-left:10px}.score svg{fill:var(--snow-color-dark1)}.score.highlight{color:var(--score-color);margin-bottom:5px}.score.highlight svg{fill:var(--score-color)}.score-final{position:absolute;width:400px;left:50%;margin-left:-200px;bottom:360px;user-select:none;opacity:0;animation-delay:.5s;transform:scale(0);opacity:0;animation-name:slow-show-up;animation-duration:.5s;animation-fill-mode:forwards;animation-timing-function:ease-in}:host(.game-started) .score-final{transform:scale(1);opacity:1;animation-name:slow-hide-off;animation-delay:initial;animation-duration:.5s;animation-fill-mode:forwards;animation-timing-function:ease-out}.score-final .current-score{display:flex;justify-content:center;align-items:center}.score-final .current-score span{margin-left:10px;font-size:32px;color:var(--score-color)}.score-final .current-score svg{fill:var(--score-color)}.score-final .best-score{margin-top:10px;font-size:14px;text-align:center;color:var(--snow-color-dark1)}.score-final .best-score span{color:var(--score-color)}@media screen and (max-width: 800px){.start-button{display:none}.score{display:none}.score-final{display:none}.caption{display:none}}@keyframes slow-show-up{from{transform:scale(0);opacity:0}to{transform:scale(1);opacity:1}}@keyframes slow-hide-off{from{transform:scale(1);opacity:1}to{transform:scale(0);opacity:0}}",K()({assetsUrl:this.getAttribute("assets-url")||"."}));const t=this.shadowRoot.querySelector('div[data-role="mute"]');t.onclick=this.toggleMute.bind(this),t.hidden=w.disabled,this.shadowRoot.querySelector('div[data-role="close"]').onclick=this.remove.bind(this),this.shadowRoot.querySelector('div[data-role="start"]').onclick=this.start.bind(this),this.shadowRoot.querySelector('div[data-role="turnoff"]').onclick=this.turnOffGame.bind(this),this.livesEl=this.shadowRoot.querySelector(".lives"),this.livesCounterEl=this.shadowRoot.querySelector(".lives span"),this.scoreEl=this.shadowRoot.querySelector(".score"),this.scoreCounterEl=this.shadowRoot.querySelector(".score span"),this.currentScoreCounterEl=this.shadowRoot.querySelector(".current-score span"),this.bestScoreCounterEl=this.shadowRoot.querySelector(".best-score span"),this.fw=this.shadowRoot.querySelector("#fw1"),this.fw.addEventListener("launch",this.handleLaunch.bind(this))}handleLaunch(t){if(!this.game.isStarted||!this.game.firework)return;const e=t.detail;e.rocketType!==this.game.firework.rocketType||e.rocketColors.join(",")!==this.game.firework.rocketColors.join(",")?this.decreaseLives():this.increaseScore(e)}increaseScore(t){let e=(Math.floor(this.fw.canvasBack.width/50)-1)/6;"type1"===t.rocketType&&(e+=1),e+=(200-this.game.duration)/20,this.game.score+=Math.round(e),this.game.score>it.getBestScore()&&it.setBestScore(this.game.score),this.game.duration=Math.max(80,this.game.duration-5),window.clearTimeout(this.game.scoreEffectTimer),this.scoreEl.classList.add("highlight"),this.game.scoreEffectTimer=window.setTimeout((()=>{this.scoreEl.classList.remove("highlight")}),100),this.updateCounters(),this.pickTargetFirework()}decreaseLives(){if(this.game.lives--,this.livesEl.classList.add("highlight"),this.game.lives<=0)return this.game.lives=0,void this.stop();window.clearTimeout(this.game.livesEffectTimer),this.game.livesEffectTimer=window.setTimeout((()=>{this.livesEl.classList.remove("highlight")}),100),this.updateCounters(),this.pickTargetFirework()}updateCounters(){this.livesCounterEl.textContent=`${this.game.lives}`,this.scoreCounterEl.textContent=`${this.game.score}`,this.currentScoreCounterEl.textContent=`${this.game.score}`,this.bestScoreCounterEl.textContent=`${it.getBestScore()}`}generateFireworks(){const t=window.innerWidth||document.documentElement.clientWidth,e=(window.innerHeight||document.documentElement.clientHeight)-90,i=Math.floor(t/50)-1;if(!(this.fireworks.size>=i))for(let t=0;t<i;t++)this.createFirework(25+50*t,e)}createFirework(t,e){const i=this.fw.getRandomFirework({x:t+Math.ceil(50*Math.random()),y:e+Math.ceil(60*Math.random())},!1);"type0"===i.rocketType?i.rocketColors=b(1,x):i.rocketColors=b(2,x),i.onLaunch=()=>{this.fireworks.has(i)&&(this.fireworks.delete(i),this.timers.add(window.setTimeout((()=>{this.createFirework(t,e)}),4e3+Math.ceil(1e3*Math.random()))))},this.fireworks.add(i),this.fw.addFirework(i).then()}pickTargetFirework(){if(!this.game.isStarted)return void window.clearInterval(this.game.timer);this.game.firework&&this.fw.removeFirework(this.game.firework),this.game.time=0,window.clearInterval(this.game.timer);let t=JSON.parse(JSON.stringify([...this.fireworks.values()][Math.floor(this.fireworks.size*Math.random())]));t.position={x:(window.innerWidth||document.documentElement.clientWidth)>>1,y:(window.innerHeight||document.documentElement.clientHeight)-300},t.angleFactor=1,t.sizeFactor=2,t.rocketFading=!0,t.onBeforeRender=this.renderTimer.bind(this),t.canBeLaunched=!1,this.game.firework=t,this.fw.addFirework(t).then(),this.fw.addFirework({position:{...t.position},sizeFactor:.3,colors:b(2),explosionType:"type0",elementsFactor:.5,noSound:!0}).then(),this.game.timer=window.setInterval(this.updateTimer.bind(this),40)}updateTimer(){if(this.game.time++,this.game.time>this.game.duration)return this.decreaseLives(),void this.pickTargetFirework();this.fw.render().then()}renderTimer(t){const e=this.game.firework,i=Math.max(0,Math.min(this.wickPath.length-1,Math.floor(this.wickPath.length*(1-this.game.time/this.game.duration))));t.translate(e.position.x,e.position.y);const{x:s,y:o}=this.wickPath[i];this.drawWick(t,i),at.drawFire(t,s,o),at.drawSparks(t,s,o)}drawWick(t,e){t.save(),t.strokeStyle="#89a556",t.lineWidth=3,t.beginPath(),t.moveTo(this.wickPath[0].x,this.wickPath[0].y);for(let i=1;i<=e;i++)t.lineTo(this.wickPath[i].x,this.wickPath[i].y);t.stroke(),t.strokeStyle="#5c703a",t.lineWidth=3,t.setLineDash([2,4]),t.beginPath(),t.moveTo(this.wickPath[0].x,this.wickPath[0].y);for(let i=1;i<=e;i++)t.lineTo(this.wickPath[i].x,this.wickPath[i].y);t.stroke(),t.restore()}static drawFire(t,e,i){t.save(),t.beginPath(),t.fillStyle=rt,t.arc(e,i,3,0,n),t.closePath(),t.fill(),t.beginPath(),t.globalAlpha=.2,t.fillStyle=rt,t.arc(e,i,10,0,n),t.closePath(),t.fill(),t.restore()}static drawSparks(t,e,i){t.save(),t.strokeStyle=rt,t.lineWidth=1,t.beginPath();for(let s=0;s<=n;s+=nt){const o=(-.5+Math.random())*nt,r=3+10*Math.random();t.moveTo(e,i),t.lineTo(e+Math.cos(s+o)*r,i+Math.sin(s+o)*r)}t.stroke(),t.restore()}turnOffGame(){confirm("Вы действительно хотите полностью скрыть фейерверки и больше её не видеть?")&&(it.turnOffGame(),this.remove())}}window.customElements.define("fw-canvas",class extends t{constructor(){super(),this.updateCanvasSize=()=>{this.canvasFront&&(this.hasAttribute("fullscreen")?(this.canvasFront.width=window.innerWidth||document.documentElement.clientWidth,this.canvasFront.height=window.innerHeight||document.documentElement.clientHeight):(this.canvasFront.width=parseInt(this.getAttribute("width"),10)||200,this.canvasFront.height=parseInt(this.getAttribute("height"),10)||100),this.canvasBack.width=this.canvasFront.width,this.canvasBack.height=this.canvasFront.height,this.rendererBack.requestRender(),this.rendererFront.requestRender())},this.bgImageLoader=Promise.resolve(),this.fireworks=new WeakMap,this.elements=new WeakMap,this.deleteList=new WeakSet,this.builder=new Q}static get observedAttributes(){return["fullscreen","width","height","bg-color","bg-image","sounds-url"]}get canvas(){return this.canvasFront}async addFirework(t){let e=t.autoLaunch||!1;const i=this.builder.createFirework(t,this.canvasFront);for(const s of i){const i=await s;if(this.deleteList.has(t))return;this.fireworks.set(t,i),this.elements.set(i,t),e||!t.canBeLaunched?this.renderListFront.add(i,0,t.onBeforeRender||null,t.onAfterRender||null):this.renderListBack.add(i,0,t.onBeforeRender||null,t.onAfterRender||null),this.rendererBack.requestRender(),this.rendererFront.requestRender()}}getRandomFirework(t,e=!0){return this.builder.getRandomFirework(t,e)}removeFirework(t){if(this.deleteList.add(t),!this.fireworks.has(t))return;const e=this.fireworks.get(t);this.renderListFront.remove(e),this.renderListBack.remove(e),this.rendererBack.requestRender(),this.rendererFront.requestRender()}removeAllFireworks(){this.renderListBack.clear(),this.renderListFront.clear(),this.rendererBack.requestRender(),this.rendererFront.requestRender()}launchFirework(t){if(this.deleteList.has(t))return;if(!this.fireworks.has(t))return;if(!t.canBeLaunched)return;const e=this.fireworks.get(t);e instanceof B&&e.launch()}async render(){return new Promise((t=>{this.rendererFront.requestRender(t)}))}connectedCallback(){this.renderElement(),this.updateCanvasSize(),window.addEventListener("resize",this.updateCanvasSize),this.preloadSounds(),this.bgImageLoader.then((()=>{this.rendererBack.start(),this.rendererFront.start()}))}disconnectedCallback(){this.rendererBack.finish(),this.rendererFront.finish(),window.removeEventListener("resize",this.updateCanvasSize)}renderElement(){this.createShadowDom(":host([fullscreen]){position:relative;display:block}canvas{position:absolute}",'\n\t\t\t\t<canvas data-role="back"></canvas>\n\t\t\t\t<canvas data-role="front"></canvas>\n\t\t\t'),this.canvasFront=this.shadowRoot.querySelector('canvas[data-role="front"]'),this.renderListFront=new s,this.rendererFront=new e(this.renderListFront,this.canvasFront.getContext("2d")),this.rendererFront.useGlowTail(),this.canvasBack=this.shadowRoot.querySelector('canvas[data-role="back"]'),this.renderListBack=new s,this.rendererBack=new e(this.renderListBack,this.canvasBack.getContext("2d")),this.rendererBack.backgroundColor=this.getAttribute("bg-color")||Z,this.rendererBack.observe(this.handleRender.bind(this)),this.canvasFront.addEventListener("click",this.handleClick.bind(this)),this.hasAttribute("bg-image")&&(this.bgImageLoader=this.rendererBack.setBackgroundImage(this.getAttribute("bg-image")||""))}handleRender(){this.dispatchEvent(new CustomEvent("render",{bubbles:!1,cancelable:!1,composed:!0}))}handleAttributesChange(){this.updateCanvasSize()}handleBgColorChange(){this.rendererBack&&(this.rendererBack.backgroundColor=this.getAttribute("bg-color")||Z)}handleBgImageChange(){this.rendererBack&&(this.bgImageLoader=this.rendererBack.setBackgroundImage(this.getAttribute("bg-image")||""))}preloadSounds(){this.hasAttribute("sounds-url")&&(w.assetsUrl=this.getAttribute("sounds-url"));for(const t of Object.values(p))new w(t).preloadFile()}handleClick(t){const{left:e,top:i}=this.getBoundingClientRect(),s=t.clientX-e,o=t.clientY-i,r=this.renderListBack.getElementUnderPoint({x:s,y:o});if(!(r instanceof B&&this.elements.has(r)))return;const n=this.elements.get(r);n.canBeLaunched&&(this.dispatchEvent(new CustomEvent("launch",{composed:!0,bubbles:!1,cancelable:!1,detail:n})),this.renderListFront.add(r,0,n.onBeforeRender||null,n.onAfterRender||null),this.rendererFront.requestRender((()=>{this.rendererBack.requestRender(),this.renderListBack.remove(r),r.launch()})))}}),window.customElements.define("fw-game1",at)})()})();